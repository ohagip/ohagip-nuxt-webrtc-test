(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{190:function(e,t,n){var content=n(195);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(74).default)("4de43d64",content,!0,{sourceMap:!1})},194:function(e,t,n){"use strict";var r=n(190);n.n(r).a},195:function(e,t,n){(t=n(73)(!1)).push([e.i,".wrap[data-v-69e88658]{margin:64px auto;width:640px;max-width:100%}.title[data-v-69e88658]{font-size:24px}.subTitle[data-v-69e88658],.title[data-v-69e88658]{margin:64px 0 0;text-align:center;font-weight:700}.subTitle[data-v-69e88658]{font-size:16px}.note[data-v-69e88658]{margin:16px 0 0;font-size:14px;line-height:1.3}.log[data-v-69e88658]{margin:24px 0 0}.log-body[data-v-69e88658]{overflow-y:scroll;margin:8px 0 0;padding:8px;width:100%;height:160px;background-color:#000;font-size:16px;line-height:1.33;color:#fff}.log-list[data-v-69e88658]{padding:0;list-style:none}.log-item[data-v-69e88658]{font-size:16px}.action[data-v-69e88658]{margin:24px 0 0}.action-item[data-v-69e88658]{display:inline-block;cursor:pointer}.action-item+.action-item[data-v-69e88658]{margin-left:16px}.video[data-v-69e88658]{margin:8px 0 0;background-color:#ccc}.video-list[data-v-69e88658]{font-size:0}.video-item[data-v-69e88658]{display:inline-block;width:49%;font-size:inherit}.video-media[data-v-69e88658]{width:100%;height:auto}",""]),e.exports=t},199:function(e,t,n){"use strict";n.r(t);n(34),n(46),n(47),n(49),n(50),n(32),n(17),n(37),n(51),n(52),n(33);var r=n(6),o=n(1);function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,d=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){d=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(d)throw o}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var d=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=o.a.extend({data:function(){return{peerConnection:void 0,sdp2Local:"",sdp2Remote:"",localVideoStream:null,remoteVideoStream:null}},mounted:function(){var e=this;this.peerConnection=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),this.remoteVideoStream=new MediaStream,this.$refs.remoteVideo.srcObject=this.remoteVideoStream,this.peerConnection.addEventListener("icecandidate",(function(t){null!==t.candidate||(console.log("icecandidate all"),void 0!==e.peerConnection&&null!==e.peerConnection.localDescription&&(e.sdp2Local=e.peerConnection.localDescription.sdp))})),this.peerConnection.addEventListener("connectionstatechange",(function(t){console.log("connectionstatechange"),void 0!==e.peerConnection&&"connected"===e.peerConnection.connectionState&&console.log("Peers connected!")})),this.peerConnection.addEventListener("track",(function(t){e.remoteVideoStream.addTrack(t.track,e.remoteVideoStream)}))},destroyed:function(){},methods:{makeOffer:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,track,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e.peerConnection){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,n={video:!0,audio:!0},t.next=6,d(n);case 6:e.localVideoStream=t.sent,e.$refs.localVideo.srcObject=e.localVideoStream,r=c(e.localVideoStream.getTracks());try{for(r.s();!(o=r.n()).done;)track=o.value,e.peerConnection.addTrack(track,e.localVideoStream)}catch(e){r.e(e)}finally{r.f()}return t.next=13,e.peerConnection.createOffer();case 13:return l=t.sent,t.next=16,e.peerConnection.setLocalDescription(l);case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(2),console.error("makeOffer",t.t0);case 21:case"end":return t.stop()}}),t,null,[[2,18]])})))()},receiveOffer:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,l,track,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==e.sdp2Remote){t.next=2;break}return t.abrupt("return");case 2:if(void 0!==e.peerConnection){t.next=4;break}return t.abrupt("return");case 4:return n=new RTCSessionDescription({type:"offer",sdp:e.sdp2Remote}),t.prev=5,r={video:!0,audio:!0},t.next=9,d(r);case 9:e.localVideoStream=t.sent,e.$refs.localVideo.srcObject=e.localVideoStream,o=c(e.localVideoStream.getTracks());try{for(o.s();!(l=o.n()).done;)track=l.value,e.peerConnection.addTrack(track,e.localVideoStream)}catch(e){o.e(e)}finally{o.f()}return t.next=16,e.peerConnection.setRemoteDescription(n);case 16:return t.next=18,e.peerConnection.createAnswer();case 18:return v=t.sent,t.next=21,e.peerConnection.setLocalDescription(v);case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(5),console.error("receiveOffer",t.t0);case 26:case"end":return t.stop()}}),t,null,[[5,23]])})))()},receiveAnswer:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("receiveAnswer"),""!==e.sdp2Remote){t.next=3;break}return t.abrupt("return");case 3:if(void 0!==e.peerConnection){t.next=5;break}return t.abrupt("return");case 5:return n=new RTCSessionDescription({type:"answer",sdp:e.sdp2Remote}),console.log("receiveAnswer answer",n),t.prev=7,t.next=10,e.peerConnection.setRemoteDescription(n);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(7),console.error("receiveAnswer",t.t0);case 15:case"end":return t.stop()}}),t,null,[[7,12]])})))()}}}),f=(n(194),n(29)),component=Object(f.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrap"},[n("div",{staticClass:"title"},[e._v("RTCPeerConnection（STUN, P2P）")]),e._v(" "),n("div",{staticClass:"action"},[n("div",{staticClass:"action-list"},[n("div",{staticClass:"action-item",on:{click:e.makeOffer}},[e._v("makeOffer（Vanilla ICEなので時間かかる）")]),e._v(" "),n("div",{staticClass:"action-item",on:{click:e.receiveOffer}},[e._v("receiveOffer")]),e._v(" "),n("div",{staticClass:"action-item",on:{click:e.receiveAnswer}},[e._v("receiveAnswer")])])]),e._v(" "),n("div",{staticClass:"video"},[n("div",{staticClass:"video-list"},[n("div",{staticClass:"video-item"},[n("video",{ref:"localVideo",staticClass:"video-media",attrs:{autoplay:"",playsinline:""}})]),e._v(" "),n("div",{staticClass:"video-item"},[n("video",{ref:"remoteVideo",staticClass:"video-media",attrs:{autoplay:"",playsinline:""}})])])]),e._v(" "),n("div",{staticClass:"log"},[n("div",{staticClass:"log-title"},[e._v("SDP（local）")]),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.sdp2Local,expression:"sdp2Local"}],staticClass:"log-body",domProps:{value:e.sdp2Local},on:{input:function(t){t.target.composing||(e.sdp2Local=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"log"},[n("div",{staticClass:"log-title"},[e._v("SDP（remote）")]),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.sdp2Remote,expression:"sdp2Remote"}],staticClass:"log-body",domProps:{value:e.sdp2Remote},on:{input:function(t){t.target.composing||(e.sdp2Remote=t.target.value)}}})])])}),[],!1,null,"69e88658",null);t.default=component.exports}}]);